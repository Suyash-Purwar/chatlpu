const a11_0x4f4e=['../../../utilities/metric-logger','FileStorage','startTask','apply','value','submitRunMetrics','dte-main','./task-graph-creator','Main\x20job\x20was\x20terminated\x20via\x20SIGINT','SIGTERM','Starting\x20distributed\x20command\x20execution','then','processTasks','completeRunGroupWithError','./split-task-graph-into-stages','runUrl','__esModule','VERBOSE_LOGGING','Main\x20job\x20was\x20terminated\x20via\x20SIGTERM','DTE\x20needs\x20the\x20cache\x20to\x20share\x20files\x20between\x20agents.','message','throw','warn','DistributedExecutionApi','getNxCacheDirectory','Successfully\x20completed\x20running\x20the\x20command.','printRunGroupError','tasks','done','../../../utilities/environment','values','canDetectRunGroup','log','getRunGroup','start','encryptionKey','ErrorReporterApi','../../api/error-reporter.api','Unable\x20to\x20complete\x20a\x20run.','axiosException','getCIExecutionId','Command\x20execution\x20failed.','E2EEncryption','projectGraph','success','../../../utilities/dte-artifact-storage','next','endTasks','taskGraph','Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','See\x20run\x20details\x20at\x20','DteArtifactStorage','exit','../../../utilities/nx-imports','getCIExecutionEnv','nxCloudDistributedTasksRunner','scheduleTask','createStartRequest','note','ENCRYPTION_KEY','./process-tasks','commandStatus','--skip-nx-cache\x20is\x20ignored\x20when\x20using\x20distributed\x20tasks\x20execution\x20(DTE).'];(function(_0x267908,_0x4f4e93){const _0x3faff9=function(_0x5a052e){while(--_0x5a052e){_0x267908['push'](_0x267908['shift']());}};_0x3faff9(++_0x4f4e93);}(a11_0x4f4e,0x105));const a11_0x3faf=function(_0x267908,_0x4f4e93){_0x267908=_0x267908-0x0;let _0x3faff9=a11_0x4f4e[_0x267908];return _0x3faff9;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x157b1e,_0x526de0,_0x506cf3,_0x3185cc){function _0x2c4b52(_0x2433ed){return _0x2433ed instanceof _0x506cf3?_0x2433ed:new _0x506cf3(function(_0x468065){_0x468065(_0x2433ed);});}return new(_0x506cf3||(_0x506cf3=Promise))(function(_0x41da31,_0x4fd519){function _0x3fdca2(_0x9bb715){try{_0x2b9f0b(_0x3185cc[a11_0x3faf('0x25')](_0x9bb715));}catch(_0x3409c3){_0x4fd519(_0x3409c3);}}function _0x2165f5(_0xb86f79){try{_0x2b9f0b(_0x3185cc[a11_0x3faf('0xc')](_0xb86f79));}catch(_0x5ac06b){_0x4fd519(_0x5ac06b);}}function _0x2b9f0b(_0x34cb76){_0x34cb76[a11_0x3faf('0x13')]?_0x41da31(_0x34cb76[a11_0x3faf('0x3a')]):_0x2c4b52(_0x34cb76[a11_0x3faf('0x3a')])[a11_0x3faf('0x2')](_0x3fdca2,_0x2165f5);}_0x2b9f0b((_0x3185cc=_0x3185cc[a11_0x3faf('0x39')](_0x157b1e,_0x526de0||[]))[a11_0x3faf('0x25')]());});};Object['defineProperty'](exports,a11_0x3faf('0x7'),{'value':!![]});exports[a11_0x3faf('0x2e')]=void 0x0;const environment_1=require(a11_0x3faf('0x14'));const metric_logger_1=require(a11_0x3faf('0x36'));const error_reporter_api_1=require(a11_0x3faf('0x1c'));const print_run_group_error_1=require('../../error/print-run-group-error');const e2e_encryption_1=require('../../file-storage/e2e-encryption');const file_storage_1=require('../../file-storage/file-storage');const distributed_execution_api_1=require('./distributed-execution.api');const split_task_graph_into_stages_1=require(a11_0x3faf('0x5'));const task_graph_creator_1=require(a11_0x3faf('0x3d'));const process_tasks_1=require(a11_0x3faf('0x33'));const dte_artifact_storage_1=require(a11_0x3faf('0x24'));const {output}=require(a11_0x3faf('0x2c'));class NoopLifeCycle{[a11_0x3faf('0x2f')](_0x3c2d0d){}[a11_0x3faf('0x38')](_0x375f7e){}[a11_0x3faf('0x26')](_0x5347b0){}}const nxCloudDistributedTasksRunner=(_0x48bfb6,_0x3da79d,_0x1e7548)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(_0x3da79d['skipNxCache']){output[a11_0x3faf('0xd')]({'title':a11_0x3faf('0x35'),'bodyLine':[a11_0x3faf('0xa')]});}if(environment_1[a11_0x3faf('0x8')]){output[a11_0x3faf('0x31')]({'title':a11_0x3faf('0x1')});}_0x3da79d['lifeCycle']=new NoopLifeCycle();const _0x572f68=(0x0,environment_1['getBranch'])();const _0x18e630=(0x0,environment_1[a11_0x3faf('0x18')])();const _0x32fd68=(0x0,environment_1[a11_0x3faf('0x1f')])();const _0x5e952f=(0x0,environment_1[a11_0x3faf('0x2d')])();if(!(0x0,print_run_group_error_1[a11_0x3faf('0x16')])(_0x18e630,_0x32fd68)){(0x0,print_run_group_error_1[a11_0x3faf('0x11')])();process[a11_0x3faf('0x2b')](0x1);}const _0x9dd7e3=new e2e_encryption_1[(a11_0x3faf('0x21'))](environment_1[a11_0x3faf('0x32')]||_0x3da79d[a11_0x3faf('0x1a')]);const _0x2357a5=new error_reporter_api_1[(a11_0x3faf('0x1b'))](_0x3da79d);const _0x222c20=new dte_artifact_storage_1[(a11_0x3faf('0x2a'))](new file_storage_1[(a11_0x3faf('0x37'))](_0x9dd7e3,_0x2357a5,_0x3da79d,a11_0x3faf('0x3c')),(0x0,environment_1[a11_0x3faf('0xf')])(_0x3da79d));const _0x551443=new distributed_execution_api_1[(a11_0x3faf('0xe'))](_0x3da79d);attachSignalListenersToCompleteRunGroupOnError(_0x551443,_0x572f68,_0x18e630,_0x32fd68,_0x5e952f);try{const _0x2c4ef7=getTaskGraph(_0x1e7548,_0x48bfb6,_0x3da79d);const _0x49d353=yield runDistributedExecution(_0x551443,_0x3da79d,_0x222c20,_0x572f68,_0x18e630,_0x32fd68,_0x5e952f,_0x2c4ef7);if(_0x49d353[a11_0x3faf('0x34')]===0x0){output[a11_0x3faf('0x23')]({'title':a11_0x3faf('0x10'),'bodyLines':[a11_0x3faf('0x29')+_0x49d353['runUrl']]});}else{output['error']({'title':a11_0x3faf('0x20'),'bodyLines':[a11_0x3faf('0x29')+_0x49d353[a11_0x3faf('0x6')]]});}yield(0x0,metric_logger_1[a11_0x3faf('0x3b')])(_0x3da79d);process['exit'](_0x49d353['commandStatus']);}catch(_0xb3e632){output['error']({'title':a11_0x3faf('0x1d'),'bodyLines':[_0xb3e632[a11_0x3faf('0xb')]]});if(_0xb3e632[a11_0x3faf('0x1e')]){console[a11_0x3faf('0x17')](_0xb3e632[a11_0x3faf('0x1e')]);}else{console[a11_0x3faf('0x17')](_0xb3e632);}try{yield _0x551443['completeRunGroupWithError'](_0x572f68,_0x18e630,_0x32fd68,_0x5e952f,a11_0x3faf('0x28')+_0xb3e632[a11_0x3faf('0xb')]+'\x22');}finally{process[a11_0x3faf('0x2b')](0x1);}}});exports[a11_0x3faf('0x2e')]=nxCloudDistributedTasksRunner;function getTaskGraph(_0x48bf22,_0x39a536,_0x58063f){if(_0x48bf22[a11_0x3faf('0x27')]){return _0x48bf22[a11_0x3faf('0x27')];}else{return(0x0,task_graph_creator_1['createTaskGraphCompat'])(_0x58063f,_0x48bf22[a11_0x3faf('0x22')],_0x39a536);}}function attachSignalListenersToCompleteRunGroupOnError(_0x233d87,_0x2937d4,_0xe6264a,_0x194418,_0x372b21){process['on']('SIGINT',()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x233d87[a11_0x3faf('0x4')](_0x2937d4,_0xe6264a,_0x194418,_0x372b21,a11_0x3faf('0x3e'));process[a11_0x3faf('0x2b')](0x1);}));process['on'](a11_0x3faf('0x0'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x233d87[a11_0x3faf('0x4')](_0x2937d4,_0xe6264a,_0x194418,_0x372b21,a11_0x3faf('0x9'));process[a11_0x3faf('0x2b')](0x1);}));}function runDistributedExecution(_0x149567,_0x269fb7,_0x563662,_0x53e110,_0x45bb8f,_0x36372a,_0x121379,_0x3ad6a1){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3e943a=yield _0x149567[a11_0x3faf('0x19')]((0x0,distributed_execution_api_1[a11_0x3faf('0x30')])(_0x53e110,_0x45bb8f,_0x36372a,_0x121379,(0x0,split_task_graph_into_stages_1['splitTasksIntoStages'])(_0x3ad6a1),_0x269fb7));return yield(0x0,process_tasks_1[a11_0x3faf('0x3')])(_0x149567,_0x563662,_0x3e943a,Object[a11_0x3faf('0x15')](_0x3ad6a1[a11_0x3faf('0x12')]));});}